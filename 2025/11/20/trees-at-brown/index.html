<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-321HPHTJEX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-321HPHTJEX');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trees@Brown</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://use.typekit.net/tgd3gjm.css">
    <link rel="icon" href="images/icon.png" sizes="96x96">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/ScrollMagic.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/debug.addIndicators.min.js"></script>
    <script src="script.js"></script>
    <!-- newspaper font -->
    <link rel="stylesheet" href="https://use.typekit.net/brt8lxm.css">
</head>

<body>
    <div id="trigger"></div>
    <div id="spacer"></div>
    <div class="full-screen-bg"
        style="background-image: url('images/background1.jpg'); background-size: cover; background-position: center; height: 100vh; width: 100%; margin: 0; padding: 0; background-repeat: no-repeat;">
    </div>
    <div id="heading">
        <a href="https://www.browndailyherald.com" target="_blank">
            <img src="images/logo-black.png" id="herald-logo" alt="Brown Daily Herald Logo" />
        </a>
        <h3 style="text-align: center;">
            Trees@Brown
        </h3>
        <p style="text-align: center;">
            The Street Trees of College Hill
        </p>
        <h6 id="byline" style="text-align: center;">
            Reporting by
            <a href="https://www.browndailyherald.com/staff/claire-song" target="_blank"><span
                    class="author">TKTK</span></a>
            <br>
            <br>
            Data analysis by
            <a href="https://www.browndailyherald.com/staff/maya-davis" target="_blank"><span
                    class="author">TKTK</span></a>
            <a href="https://www.browndailyherald.com/staff/kenna-lee" target="_blank"><span
                    class="author">TKTK</span></a>
            <a href="https://www.browndailyherald.com/staff/claire-song" target="_blank"><span
                    class="author">TKTK</span></a>
            <br>
            <br>
            Web design by
            <a href="https://www.browndailyherald.com/staff/caleb-ellenberg" target="_blank"><span
                    class="author">TKTK</span></a>

            <a href="https://www.browndailyherald.com/staff/kenna-lee" target="_blank"><span
                    class="author">TKTK</span></a>
        </h6>
        <div class="down-arrow" style="text-align: center;">
            &#x2193;
        </div>
    </div>

 <div class="data-box">
  
    <!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Tree Map (Brown Campus)</title>

    <!-- Leaflet CSS -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <!-- MarkerCluster CSS -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css"
    />

    <style>
      #map {
        height: 800px;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <h2>Tree Map (Brown Campus)</h2>
    <div id="map"></div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- MarkerCluster JS -->
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    <!-- Papa Parse for reading CSV -->
    <script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>

    <script>
      // Load CSV file using Papa Parse
      Papa.parse("Brown_Trees_Dataset_New.csv", {
        download: true,
        header: true,
        dynamicTyping: true,
        complete: function (results) {
          const trees = results.data;

          // Filter out rows without coordinates
          const validTrees = trees.filter(
            (t) => t.latitude && t.longitude
          );

          // Compute map center
          const avgLat =
            validTrees.reduce((sum, t) => sum + t.latitude, 0) /
            validTrees.length;
          const avgLon =
            validTrees.reduce((sum, t) => sum + t.longitude, 0) /
            validTrees.length;

          // Initialize map
          const map = L.map("map").setView([avgLat, avgLon], 15);

          // Add base layer
          L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
            attribution:
              'Map data Â© <a href="https://openstreetmap.org">OpenStreetMap</a> contributors',
          }).addTo(map);

          // Create MarkerCluster group
          const markerCluster = L.markerClusterGroup();

          // Add tree markers
          validTrees.forEach((tree) => {
            const popupContent = `
              <b>Species:</b> ${tree.SPP || "Unknown"}<br>
              <b>Diameter:</b> ${tree.DBH || "N/A"} inches
            `;
            const marker = L.marker([tree.latitude, tree.longitude]).bindPopup(
              popupContent
            );
            markerCluster.addLayer(marker);
          });

          // Add clusters to map
          map.addLayer(markerCluster);
        },
      });
    </script>
    
  </body>
</html>